<!-- [Mobile Media Block] start -->
<div class="me-auto pc-mob-drp">
<ul class="inline-flex *:min-h-header-height *:inline-flex *:items-center">
 <!-- ======= Menu collapse Icon ===== -->
 <li class="pc-h-item pc-sidebar-collapse max-lg:hidden lg:inline-flex">
   <a href="#" class="pc-head-link ltr:!ml-0 rtl:!mr-0" id="sidebar-hide">
     <i data-feather="menu"></i>
   </a>
 </li>
 <li class="pc-h-item pc-sidebar-popup lg:hidden">
   <a href="#" class="pc-head-link ltr:!ml-0 rtl:!mr-0" id="mobile-collapse">
     <i data-feather="menu"></i>
   </a>
 </li>
 <li class="dropdown pc-h-item">
   <a class="pc-head-link dropdown-toggle me-0" data-pc-toggle="dropdown" href="#" role="button"
     aria-haspopup="false" aria-expanded="false">
     <i data-feather="search"></i>
   </a>
   <div class="dropdown-menu pc-h-dropdown drp-search">
     <form class="px-2 py-1">
       <input type="search" class="form-control !border-0 !shadow-none" placeholder="Search here. . ." />
     </form>
   </div>
 </li>
</ul>
</div>
<!-- [Mobile Media Block end] -->
<div class="ms-auto">
<ul class="inline-flex *:min-h-header-height *:inline-flex *:items-center">
 <li class="dropdown pc-h-item">
   <a class="pc-head-link dropdown-toggle me-0" data-pc-toggle="dropdown" href="#" role="button"
     aria-haspopup="false" aria-expanded="false">
     <i data-feather="sun"></i>
   </a>
   <div class="dropdown-menu dropdown-menu-end pc-h-dropdown">
     <a href="#!" class="dropdown-item" onclick="layout_change('dark')">
       <i data-feather="moon"></i>
       <span>Dark</span>
     </a>
     <a href="#!" class="dropdown-item" onclick="layout_change('light')">
       <i data-feather="sun"></i>
       <span>Light</span>
     </a>
     <a href="#!" class="dropdown-item" onclick="layout_change_default()">
       <i data-feather="settings"></i>
       <span>Default</span>
     </a>
   </div>
 </li>
 <!-- Notification dropdown - will be hidden for non-Direktur users -->
 <li class="dropdown pc-h-item notification-dropdown" data-role="Direktur" style="display: none;">
   <a class="pc-head-link dropdown-toggle me-0 notification-trigger" data-pc-toggle="dropdown" href="#" role="button"
     aria-haspopup="false" aria-expanded="false" id="notificationTrigger">
     <i data-feather="bell" class="notification-icon"></i>
     <span class="notification-badge" style="display: none;">0</span>
   </a>
   <div class="dropdown-menu dropdown-notification dropdown-menu-end pc-h-dropdown" style="display: none !important; position: absolute; top: 100%; right: 0; transform: translateY(0); opacity: 0; visibility: hidden;">
     <!-- Header -->
     <div class="notification-header">
       <div class="d-flex align-items-center justify-content-between">
         <div class="d-flex align-items-center">
           <i data-feather="bell" class="me-2 notification-header-icon"></i>
           <h6 class="mb-0 fw-semibold text-white">Notifikasi</h6>
         </div>
         <div class="d-flex align-items-center gap-2">
           <button class="btn btn-sm btn-secondary mark-all-read-btn">
             Tandai Semua
           </button>
           <button class="btn btn-sm btn-danger clear-all-btn">
             Hapus Semua
           </button>
         </div>
       </div>
     </div>
     
     <!-- Body -->
     <div class="notification-body">
       <div class="loading-state text-center py-5">
         <div class="spinner-border spinner-border-sm text-primary mb-2" role="status">
           <span class="visually-hidden">Loading...</span>
         </div>
         <p class="text-muted mb-0 small">Memuat notifikasi...</p>
       </div>
     </div>
     
     <!-- Footer -->
     <div class="notification-footer">
       <a href="#!" class="text-decoration-none text-primary fw-medium small">Lihat Semua Notifikasi</a>
     </div>
   </div>
 </li>
 <li class="dropdown pc-h-item header-user-profile">
   <a class="pc-head-link dropdown-toggle arrow-none me-0" data-pc-toggle="dropdown" href="#" role="button"
     aria-haspopup="false" data-pc-auto-close="outside" aria-expanded="false">
     <img src="../assets/images/user/avatar-2.jpg" alt="user-image" class="user-avtar" />
   </a>
   <div class="dropdown-menu dropdown-user-profile dropdown-menu-end pc-h-dropdown p-2 overflow-hidden">
     <div class="dropdown-header flex items-center justify-content-between py-4 px-5 bg-primary-500">
       <div class="flex mb-1 items-center">
         <div class="shrink-0">
           <img src="../assets/images/user/avatar-2.jpg" alt="user-image" class="w-10 rounded-full" />
         </div>
         <div class="grow ms-3">
           <h6 class="mb-1 text-white" data-user-name>Loading... ðŸ––</h6>
           <span class="text-white" data-user-email>Loading...</span>
         </div>
       </div>
     </div>
     <div class="dropdown-body py-4 px-5">
       <div class="profile-notification-scroll position-relative" style="max-height: calc(100vh - 225px)">
         <div class="grid my-3">
           <button class="btn btn-primary flex items-center justify-center" id="logoutButton">
             <svg class="pc-icon me-2 w-[22px] h-[22px]">
               <use xlink:href="#custom-logout-1-outline"></use>
             </svg>
             Logout
           </button>
         </div>
       </div>
     </div>
   </div>
 </li>
</ul>
</div>

<style>
/* Modern Notification Styles - Fixed Layout & Hover Issues */
.notification-dropdown .dropdown-menu {
 width: 380px;
 max-width: 95vw;
 border-radius: 12px;
 overflow: hidden;
 border: none;
 box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
 transform-origin: top;
 margin-top: 8px;
 /* Force hide by default with proper positioning */
 display: none !important;
 visibility: hidden !important;
 opacity: 0 !important;
 position: absolute !important;
 top: 100% !important;
 right: 0 !important;
 transform: translateY(-10px) scale(0.95) !important;
 transition: all 0.2s cubic-bezier(0.16, 1, 0.3, 1) !important;
 z-index: 1050 !important;
}

/* Only show when parent has drp-show class with smooth animation */
.notification-dropdown.drp-show .dropdown-menu {
 display: block !important;
 visibility: visible !important;
 opacity: 1 !important;
 transform: translateY(0) scale(1) !important;
}

/* Notification Trigger - Fixed Hover Issue */
.notification-trigger {
 position: relative;
 display: flex;
 align-items: center;
 justify-content: center;
 transition: all 0.2s ease;
}

.notification-trigger:hover {
 transform: none !important;
 background-color: rgba(0, 0, 0, 0.05) !important;
}

.notification-trigger:hover .notification-icon {
 transform: none !important;
 color: inherit !important;
}

/* Badge - Fixed Positioning & Hover Issues */
.notification-badge {
 position: absolute;
 top: -6px;
 right: -6px;
 background: #dc3545;
 color: white;
 font-size: 0.65rem;
 font-weight: 700;
 min-width: 18px;
 height: 18px;
 border-radius: 50%;
 display: flex;
 align-items: center;
 justify-content: center;
 border: 2px solid white;
 box-shadow: 0 2px 6px rgba(220, 53, 69, 0.4);
 z-index: 1000;
 animation: pulse 2s infinite;
 pointer-events: none;
}

@keyframes pulse {
 0%, 100% {
   transform: scale(1);
 }
 50% {
   transform: scale(1.1);
 }
}

/* Header */
.notification-header {
 background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
 padding: 16px 20px;
}

.notification-header-icon {
 width: 20px;
 height: 20px;
 color: white;
}

.notification-header .btn {
 font-size: 0.75rem;
 padding: 0.25rem 0.75rem;
 border-radius: 6px;
 transition: all 0.2s ease;
}

.notification-header .btn:hover {
 background: rgba(255, 255, 255, 0.2);
 transform: translateY(-1px);
}

/* Body */
.notification-body {
 max-height: 420px;
 overflow-y: auto;
 overflow-x: hidden;
 background: white;
 scrollbar-width: thin;
 scrollbar-color: #cbd5e0 #f7fafc;
}

.notification-body::-webkit-scrollbar {
 width: 6px;
}

.notification-body::-webkit-scrollbar-track {
 background: #f7fafc;
 border-radius: 3px;
}

.notification-body::-webkit-scrollbar-thumb {
 background: #cbd5e0;
 border-radius: 3px;
 transition: background 0.2s ease;
}

.notification-body::-webkit-scrollbar-thumb:hover {
 background: #a0aec0;
}

/* Notification Items - Fixed Alignment */
.notification-item {
 padding: 16px 20px;
 border-bottom: 1px solid #f1f5f9;
 transition: all 0.2s ease;
 border-left: 3px solid transparent;
 cursor: pointer;
 position: relative;
}

.notification-item:not(.read) {
 background: linear-gradient(90deg, rgba(99, 102, 241, 0.03) 0%, rgba(255, 255, 255, 1) 100%);
 border-left-color: #6366f1;
}

.notification-item:hover {
 background: #f8fafc;
 transform: translateX(2px);
 box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
}

.notification-item.read {
 opacity: 0.75;
}

.notification-item:last-child {
 border-bottom: none;
}

/* Avatar - Fixed Alignment */
.notification-avatar {
 width: 44px;
 height: 44px;
 border-radius: 50%;
 display: flex;
 align-items: center;
 justify-content: center;
 font-weight: 600;
 font-size: 0.875rem;
 border: 2px solid white;
 box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
 flex-shrink: 0;
}

/* Content - Fixed Alignment */
.notification-content {
 flex: 1;
 min-width: 0;
 display: flex;
 flex-direction: column;
 justify-content: center;
}

.notification-title {
 font-size: 0.875rem;
 font-weight: 600;
 color: #1f2937;
 line-height: 1.3;
 margin: 0 0 4px 0;
 display: -webkit-box; /* Keep for broader compatibility */
 -webkit-box-orient: vertical; /* Keep for broader compatibility */
 overflow: hidden;
 line-clamp: 2; /* Standard property */
}

.notification-description {
 font-size: 0.8125rem;
 color: #6b7280;
 line-height: 1.4;
 margin: 0 0 8px 0;
 display: -webkit-box; /* Keep for broader compatibility */
 -webkit-box-orient: vertical; /* Keep for broader compatibility */
 overflow: hidden;
 line-clamp: 2; /* Standard property */
}

.notification-meta {
 display: flex;
 align-items: center;
 gap: 8px;
 font-size: 0.7rem;
 color: #9ca3af;
}

.notification-time {
 font-size: 0.75rem;
 color: #6b7280;
 white-space: nowrap;
 flex-shrink: 0;
 margin-left: auto;
 font-weight: 500;
}

/* Date Separator - Fixed Alignment */
.notification-date-separator {
 background: #f9fafb;
 border-bottom: 1px solid #e5e7eb;
 padding: 8px 20px;
 font-size: 0.75rem;
 font-weight: 600;
 color: #6b7280;
 text-transform: uppercase;
 letter-spacing: 0.5px;
 position: sticky;
 top: 0;
 z-index: 10;
}

/* Unread Indicator */
.unread-dot {
 width: 8px;
 height: 8px;
 background: #ef4444;
 border-radius: 50%;
 position: absolute;
 top: 16px;
 right: 16px;
 animation: blink 2s infinite;
}

@keyframes blink {
 0%, 50% { opacity: 1; }
 51%, 100% { opacity: 0.3; }
}

/* Empty State */
.empty-state {
 padding: 3rem 2rem;
 text-align: center;
}

.empty-state-icon {
 width: 64px;
 height: 64px;
 margin: 0 auto 1rem;
 background: #f3f4f6;
 border-radius: 50%;
 display: flex;
 align-items: center;
 justify-content: center;
 color: #9ca3af;
}

/* Footer */
.notification-footer {
 border-top: 1px solid #e5e7eb;
 background: #f9fafb;
 padding: 12px 20px;
 text-align: center;
}

/* Responsive Design */
@media (max-width: 768px) {
 .notification-dropdown .dropdown-menu {
   width: 350px !important;
   max-width: calc(100vw - 20px) !important;
   margin-right: 10px;
 }
 
 .notification-body {
   max-height: 350px !important;
 }
 
 .notification-item {
   padding: 12px 16px !important;
 }
 
 .notification-header {
   padding: 12px 16px !important;
 }
 
 .notification-date-separator {
   padding: 6px 16px !important;
 }
}

@media (max-width: 480px) {
 .notification-dropdown .dropdown-menu {
   width: 320px !important;
 }
 
 .notification-header .d-flex.gap-2 {
   flex-direction: column;
   gap: 0.25rem !important;
 }
 
 .notification-header .btn {
   font-size: 0.7rem !important;
   padding: 0.2rem 0.5rem !important;
 }
 
 .notification-avatar {
   width: 36px !important;
   height: 36px !important;
 }
}

/* Loading State */
.loading-state {
 display: flex;
 flex-direction: column;
 align-items: center;
 justify-content: center;
 padding: 2rem;
}

.spinner-border-sm {
 width: 1.5rem;
 height: 1.5rem;
}
</style>

<script>
 // This script will be enhanced by role-based-menu.js
 // Keep the basic logout functionality as fallback
 function handleLogout() {
   localStorage.clear(); 
   window.location.href = '../pages/login-v1.html'; 
 }

 // Fallback logout handler if role-based-menu.js doesn't load
 document.addEventListener('DOMContentLoaded', function() {
   const logoutBtn = document.getElementById('logoutButton');
   if (logoutBtn && !logoutBtn.hasAttribute('data-enhanced')) {
     logoutBtn.addEventListener('click', handleLogout);
   }
 });
</script>
